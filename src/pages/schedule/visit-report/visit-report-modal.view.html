<ion-header>
  <ion-navbar>
    <ion-buttons start>
      <button ion-button (click)="dismiss()">Close</button>
    </ion-buttons>
    <ion-title>
      Visit Report
    </ion-title>
  </ion-navbar>
</ion-header>
<ion-content no-padding>
  <ion-grid>

    <ion-row class="header-row">
      <ion-col><p>Visit Details</p></ion-col>
    </ion-row>

    <ion-row>
      <ion-col col-3><b>Name</b></ion-col>
      <ion-col col-9>{{ visit.user.firstName + ' ' + visit.user.lastName }}</ion-col>
    </ion-row>

    <ion-row>
      <ion-col col-3><b>Brand</b></ion-col>
      <ion-col col-9>{{ visit.brand.name }}</ion-col>
    </ion-row>

    <ion-row>
      <ion-col col-3><b>Location</b></ion-col>
      <ion-col col-4>{{ visit.location.name }}</ion-col>
      <ion-col col-5>{{ visit.location.type }}</ion-col>
    </ion-row>

    <ion-row>
      <ion-col col-3><b>Retailer</b></ion-col>
      <ion-col col-4>{{ visit.retailer.name }}</ion-col>
      <ion-col col-5>{{ visit.retailer.type }}</ion-col>
    </ion-row>

    <ion-row margin-top class="header-row">
      <ion-col><p>Time Reporting</p></ion-col>
    </ion-row>

    <ion-row>
      <ion-col col-4><b>Scheduled</b></ion-col>
      <ion-col col-4>{{ visit.scheduledArrival | amDateFormat: 'DD/MM/YY' }}</ion-col>
      <ion-col col-4>{{ visit.scheduledArrival | amDateFormat: 'hh:mm' }}</ion-col>
    </ion-row>

    <ion-row>
      <ion-col col-4><b>Check In</b></ion-col>
      <ion-col col-4>{{ visit.actualArrival | amDateFormat: 'DD/MM/YY' }}</ion-col>
      <ion-col col-4>{{ visit.actualArrival | amDateFormat: 'HH:mm' }}</ion-col>
    </ion-row>

    <ion-row>
      <ion-col col-4><b>Check Out</b></ion-col>
      <ion-col col-4>{{ visit.actualDeparture | amDateFormat: 'DD/MM/YY' }}</ion-col>
      <ion-col col-4>{{ visit.actualDeparture | amDateFormat: 'HH:mm' }}</ion-col>
    </ion-row>

    <ion-row class="total-row">
      <ion-col col-4><b>Time On Site</b></ion-col>
      <ion-col col-4></ion-col>
      <ion-col col-4>{{ timeSpent(visit.actualDeparture, visit.actualArrival) }} hrs</ion-col>
    </ion-row>

    <ion-row class="total-row">
    <ion-col col-4><b>Visit Total</b></ion-col>
    <ion-col col-4>£{{ visit.brand.hourlyRate}}/hr</ion-col>
    <ion-col col-4>£{{ (timeSpent(visit.actualDeparture, visit.actualArrival) * visit.brand.hourlyRate) | number: '1.2-2' }}</ion-col>
    </ion-row>


    <ion-row margin-top class="header-row">
      <ion-col><p>Store Details</p></ion-col>
    </ion-row>

    <ion-row>
      <ion-col><b>Store Contact</b></ion-col>
    </ion-row>
    <ion-row>
      <ion-col col-9>{{ visit.siteContact }}</ion-col>
    </ion-row>

    <ion-row>
      <ion-col><b>Activities/Notes</b></ion-col>
    </ion-row>
    <ion-row>
      <ion-col>{{ visit.visitNotes }}</ion-col>
    </ion-row>

    <ion-row margin-top class="header-row">
      <ion-col><p>Stock Check</p></ion-col>
    </ion-row>
    <ion-row *ngIf="visit.stock.length === 0">
      <p>No data to display</p>
    </ion-row>
    <ion-row class="total-row">
      <ion-col col-4>Product</ion-col>
      <ion-col col-4>Size</ion-col>
      <ion-col col-4>Qty On Hand</ion-col>
    </ion-row>
    <ion-row *ngFor="let check of visit.stock">
      <ion-col col-4>{{ check.product.description }}</ion-col>
      <ion-col col-4>{{ check.product.size }}</ion-col>
      <ion-col col-4>{{ check.onHand }}</ion-col>
    </ion-row>

    <ion-row margin-top class="header-row">
      <ion-col><p>Sales Report</p></ion-col>
    </ion-row>
    <ion-row *ngIf="visit.stock.length === 0">
      <p>No data to display</p>
    </ion-row>
    <ion-row class="total-row">
      <ion-col col-3>Product</ion-col>
      <ion-col col-3>Size</ion-col>
      <ion-col col-3>Sold</ion-col>
      <ion-col col-3>Value</ion-col>
    </ion-row>
    <ion-row *ngFor="let check of visit.stock">
      <ion-col col-3>{{ check.product.description }}</ion-col>
      <ion-col col-3>{{ check.product.size }}</ion-col>
      <ion-col col-3>{{ check.qtySold }}</ion-col>
      <ion-col col-3>£{{ (check.qtySold * check.product.retailPrice) | number: '1.2-2' }}</ion-col>
    </ion-row>
    <ion-row class="total-row">
      <ion-col col-3></ion-col>
      <ion-col col-3></ion-col>
      <ion-col col-3></ion-col>
      <ion-col col-3>£{{ totalSales() | number: '1.2-2' }}</ion-col>
    </ion-row>


  </ion-grid>
</ion-content>

<ion-footer>

</ion-footer>
